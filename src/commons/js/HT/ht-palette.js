!function(p,X,I){"use strict";var H="px",G="0",P="innerHTML",U="className",z=ht.Default,x=ht.Color,s=ht.Node,b="position",Q="top",d="left",c=z.animate,n=z.getInternal(),Z="width",G="0",V="none",v="max-height",C="font",f="background",F="border-box",Y="user-select",w="box-sizing",u="overflow",e=z.isTouchable,n=z.getInternal(),E=x.titleIconBackground,M=z.scrollBarInteractiveSize,O=/msie 9/.test(p.navigator?p.navigator.userAgent.toLowerCase():""),R=null,N=function(){return document},L=function($){return N().createElement($)},q=function(){return L("div")},o=function(){var Q=q(),n=Q.style;return n.msTouchAction=V,n.cursor="default",e&&n.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",R),n.position="absolute",n.left=G,n.top=G,Q},y=function(){return L("canvas")},r=function(){return document.body},K=function(d,c,J){d.style.setProperty(c,J,R)},T=function(f,g){f.style.removeProperty(g)},a=function(x,_,E){z.def(ht.widget[x],_,E)},D=function(o,T){o.appendChild(T)},h=function(g,$){g.removeChild($)},S=function(c,C,I,M){c.addEventListener(C,I,!!M)};n.addMethod(z,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:E,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:E}]},paletteTitleLabelColor:z.labelSelectColor,paletteTitleLabelFont:z.labelFont,paletteContentLabelFont:z.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:z.widgetTitleHeight,paletteTitleBackground:x.titleBackground,paletteTitleHoverBackground:x.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:I,paletteItemHoverBorderColor:x.highlight,paletteItemSelectBackground:x.highlight},!0);var i=".palette-item:hover{border: 1px solid "+z.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+z.paletteTitleHoverBackground+" !important}",t=document.createElement("style");e||(t.styleSheet?t.styleSheet.cssText=i:t.appendChild(N().createTextNode(i))),N().getElementsByTagName("head")[0].appendChild(t);var W=function(J){var u=this;u.$22h=J,u.addListeners()};z.def(W,X,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var I=this;I.$36h&&r().removeChild(I.$36h),I.$23h=I.$24h=I.$25h=I.$35h=I.$36h=R},handle_touchstart:function(r){for(var S,F=this,N=F.$22h,m=r.target,k=N.sm(),Z=N.dm(),b="palette-header",Q="palette-header-tool",O="palette-item",I=!1,w=!1,a=!1;m&&(m[U]||"").indexOf(b)<0&&(m[U]||"").indexOf(O)<0;)m=m.parentNode;if(m&&m[U].indexOf(Q)>=0?I=!0:m&&m[U].indexOf(b)>=0?a=!0:m&&m[U].indexOf(O)>=0&&(w=!0),z.isLeftButton(r))if(F.$27h(r))F.$24h=z.getClientPoint(r),F.$25h=N.ty();else if(I){z.preventDefault(r),S=m.parentNode.$11h;var X=Z.getDataById(S),h=X.s("tools")[m.toolIndex];h.action&&h.action.call(N)}else if(a){z.preventDefault(r),S=m.$11h;var X=Z.getDataById(S);X.isExpanded()?X.setExpanded(!1):X.setExpanded(!0)}else if(w){S=m.$11h;var P=Z.getDataById(S);k.ss(P),N.handleDragAndDrop&&(z.preventDefault(r),P.s("draggable")&&(N.handleDragAndDrop(r,"prepare"),F.$35h=0)),P.s("draggable")||(z.preventDefault(r),F.$24h=z.getClientPoint(r),F.$25h=N.ty())}else z.preventDefault(r),F.$24h=z.getClientPoint(r),F.$25h=N.ty();else F.$26h(r)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40,p.wheelDelta!==p.wheelDeltaX)},handle_DOMMouseScroll:function(m){this.handleScroll(m,-m.detail,1)},handleScroll:function(C,x,b){var r=this.$22h;z.preventDefault(C),b&&r._41o()&&r.ty(r.ty()+20*x)},handle_mouseup:function(d){this.handle_touchend(d)},handle_touchend:function(Y){var U=this;U.$37h(Y),U.$26h(Y)},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(U){var m=this;m.$37h(U),m.$26h(U)},$37h:function(n){var W=this,f=W.$22h;2===W.$35h&&(W.$35h=3,f.handleDragAndDrop(n,"end"))},handleWindowMouseMove:function(S){this.handleWindowTouchMove(S)},handleWindowTouchMove:function(v){var J=this,l=J.$22h,V=J.$23h,T=J.$24h,r=J.$25h,Q=z.getClientPoint(v),d=l._29I,O=J.$36h;if(1===J.$35h||2===J.$35h){if(J.$35h=2,l.handleDragAndDrop(v,"between"),e){var F=v.touches[0];v=F?F:v.changedTouches[0]}O.style.left=v.pageX-parseInt(O.width)/2+H,O.style.top=v.pageY-parseInt(O.height)/2+H}else"p"===V?l.ty(r+Q.y-T.y):"v"===V&&l.ty(r+(T.y-Q.y)/d.height*l._59I)},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(Q){if(!z.isDragging()&&z.isLeftButton(Q)){var s=this,V=s.$22h,l=s.$27h(Q);if(s.$24h){if(!s.$23h){if(z.getDistance(z.getClientPoint(Q),s.$24h)<2)return;s.$23h=l?"v":"p",z.startDragging(s)}}else if(l)V._43o();else if(0===s.$35h){if(s.$35h=1,V.handleDragAndDrop(Q,"begin"),e){var i=Q.touches[0];Q=i?i:Q.changedTouches[0]}var $=s.$36h=new Image,N=V.$10h[V.sm().ld().getId()].querySelector(".image-box"),X=parseInt(N.style.width),b=parseInt(N.style.height);$.draggable=!1,$.src=N.toDataURL(),$.width=X,$.height=b,$.style.position="absolute",$.style.left=Q.pageX-X/2+H,$.style.top=Q.pageY-b/2+H,r().appendChild($),z.startDragging(s)}}},$27h:function(r){var b=this.$22h,i=b.getView(),v=i.getBoundingClientRect(),k=b._29I,d=r.clientX-v.left+i.scrollLeft;return b._41o()&&k.x+k.width-d<M}}),ht.widget.Palette=function(b){var y=this,x=y._view=n.createView(null,y);y.$9h={},y.$10h={},y.$4h={},y._29I={x:0,y:0,width:0,height:0},y._59I=0,y.dm(b?b:new ht.DataModel),x[U]="ht-widget-palette",y.$29h=new W(y),K(x,f,z.paletteContentBackground),K(x,u,"auto"),K(x,w,F),K(x,"-moz-"+w,F),K(x,"-webkit-"+Y,V),K(x,"-moz-"+Y,V),K(x,"-ms-"+Y,V),K(x,Y,V),K(x,"position","absolute"),K(x,"overflow","hidden"),D(x,y._79O=o()),S(x,"dragstart",function(R){R.dataTransfer&&(R.dataTransfer.setData("Text","nodeid:"+R.target.$11h),R.dataTransfer.effectAllowed="all",y.$29h.$26h())})},a("Palette",X,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:z.autoHideScrollBar,_scrollBarSize:z.scrollBarSize,_scrollBarColor:z.scrollBarColor,getViewRect:function(){return this._29I},ty:function(S){return S==R?this.getTranslateY():(this.setTranslateY(S),void 0)},setTranslateY:function(O){if(this.$32h==R){var z=this,y=z.$33h(O),N=z.$30h;z.$30h=y,z.fp("translateY",N,y)}},getTranslateY:function(){return this.$30h},setLayout:function(h){var n,M,k=this,l=k._layout;k._layout=h,"smallicons"===h?n=M=20:"iconsonly"===h?n=M=50:(n=70,M=50),k.setItemImageWidth(n),k.setItemImageHeight(M),k.setItemImagePadding(4),k.fp("layout",l,h)},getDataAt:function(K){for(var v=K.target;v&&v.$11h==R;)v=v.parentNode;return v&&v.$11h!=R?this.getDataModel().getDataById(v.$11h):void 0},$20h:function(){var G=16;return e&&(G*=1.2),G},$19h:function(){return z.paletteTitleHeight},$18h:function(){var d=z.paletteSeparatorWidth,S=z.paletteTitleBackground,a=z.paletteSeparatorColor||z.brighter(S);return d+H+" solid "+a},$17h:function(U){K(U,"cursor","pointer"),K(U,"display","inline-block"),K(U,"margin-right",(e?8:4)+H),K(U,"vertical-align",Q)},$1h:function(g){var O=this,M=q(),p=q(),V=L("span");M[U]="palette-header",K(M,b,"relative"),K(M,f,z.paletteTitleBackground),K(M,"color",z.paletteTitleLabelColor),K(M,Q,G),K(M,w,F),K(M,"-moz-"+w,F),K(M,"padding","0 5px 0 0"),K(M,"border-top",O.$18h()),K(M,Z,"100%"),K(M,"cursor","pointer"),K(M,"white-space","nowrap"),K(M,u,"hidden"),K(M,C,z.paletteTitleLabelFont),K(M,"line-height",O.$19h()+H),M.$11h=g.getId();var e=y(),s=O.$19h(),R=O.$20h();O.$17h(e),n.setCanvas(e,R,s),D(M,e);var E=g.s("tools");if(E)for(var t=0;t<E.length;t++){var i=y();O.$17h(i),n.setCanvas(i,R,s),i[U]="palette-header-tool palette-header-tool"+g.getId()+"-"+t,i.style.position="absolute",i.style.right=(R+10)*t+"px",i.toolIndex=t,D(M,i)}return e[U]="palette-toggle-icon-"+g.getId(),p[U]="palette-content",K(p,"max-height",0+H),K(p,C,z.paletteContentLabelFont),K(p,u,"hidden"),p.$11h=g.getId(),O.$9h[g.getId()]=p,V[P]=g.getName(),K(V,C,z.paletteTitleLabelFont),D(M,e),D(M,V),[M,p]},$2h:function(J){var x=this,f=x._layout,F=O&&J.s("draggable")?L("a"):q(),b=y(),l=q(),A=J.getName()||"",Y=J.s("title")||J.getToolTip()||A,$=x._itemMargin;b[U]="image-box";var Z=x.getItemImageWidth(),i=x.getItemImageHeight();return n.setCanvas(b,Z,i),D(F,b),l[P]=A,l[U]="label-box","iconsonly"!==f&&D(F,l),F[U]="palette-item",K(F,"vertical-align",Q),K(F,"cursor","pointer"),K(F,"border-radius",5+H),K(F,"border","1px solid transparent"),K(F,"text-align","center"),K(F,"display","inline-block"),K(F,"margin-left",$+H),K(F,"margin-top",$+H),K(F,"color",z.paletteContentLabelColor),"smallicons"===f?(K(b,"vertical-align","middle"),K(F,"margin-left",2+H),K(F,"margin-top",2+H),K(F,"padding",2+H),K(F,"text-align",d),K(l,"display","inline-block"),K(l,"min-width",x.$21h+x._itemMargin+H)):"largeicons"===f&&(K(l,"max-width",Z+H),K(l,"overflow","hidden")),F.$11h=J.getId(),Y&&(F.title=Y),J.s("draggable")&&!x.handleDragAndDrop&&(O?(F.href="#",K(F,"text-decoration",V)):F.draggable="true"),F},$16h:function($,S,o,X){var R=n.initContext($);n.translateAndScale(R,0,0,1),R.clearRect(0,0,o,o);var V=(o-X)/2;z.drawStretchImage(R,z.getImage(S),"fill",0,V,X,X),R.restore()},$15h:function(M){var h=this,H=M.getId(),_=h._view.querySelector(".palette-toggle-icon-"+H),W=M.isExpanded()?z.paletteCollapseIcon:z.paletteExpandIcon;if(_&&W){var P=h.$19h(),e=h.$20h();h.$16h(_,W,P,e)}},_drawToolsIcon:function(I){var V=this,y=I.s("tools");if(y)for(var u=0;u<y.length;u++){var g=V._view.querySelector(".palette-header-tool"+I.getId()+"-"+u),c=y[u].icon,T=V.$19h(),r=V.$20h();V.$16h(g,c,T,r)}},$14h:function(q){var t=this,V=q.getId(),W=t.$10h[V].querySelector(".image-box"),F=q.getImage(),o=q.s("image.stretch");if(W&&F){var M=n.initContext(W),U=t.getItemImagePadding();U="smallicons"===t._layout?U/2:U;var x=t.getItemImageWidth()-2*U,j=t.getItemImageHeight()-2*U;n.translateAndScale(M,0,0,1),M.clearRect(0,0,x,j),z.drawStretchImage(M,z.getImage(F),o,U,U,x,j,q,t),M.restore()}},validateImpl:function(){var E,M,b,$=this,t=$.$9h,x=$._layout,r=$.$10h,I=$.$4h,Q=$._view,q=$.dm();if($.$13h&&(delete $.$13h,I={},q.each(function(L){I[L.getId()]=L})),"smallicons"===x)for(var Z in I){var a=I[Z];if(a instanceof s){var u=a.getName()||"",C=z.getTextSize(z.paletteContentLabelFont,u).width;$.$21h!=R&&$.$21h>C||($.$21h=C)}}for(var Z in I){b=I[Z];var S,f;if(q.contains(b)){if(b instanceof ht.Group){var B,e=$.$1h(b),U=r[b.getId()];U&&(B=U.nextSibling,h(Q,B),h(Q,U)),M=q.getSiblings(b).indexOf(b);var N=Q.children[2*M]||$._79O;N&&N.parentNode?(Q.insertBefore(e[0],N),Q.insertBefore(B||e[1],N)):(Q.appendChild(e[0]),Q.appendChild(B||e[1])),r[b.getId()]=e[0],E=t[b.getId()]=B||e[1],f=b.$12h;var g=b.s("promptText");f||(b.$12h=L("div"),b.$12h[P]=g||"",f=b.$12h),0===b.getChildren().size()?E.contains(f)||D(E,f):E.contains(f)&&h(E,f)}else if(S=b.getParent()){var k=$.$2h(b),K=r[b.getId()];E=t[S.getId()],K&&h(K.parentNode,K),M=q.getSiblings(b).indexOf(b);var X=E.children[M];X?E.insertBefore(k,X):D(E,k),r[b.getId()]=k,$.$14h(b)}}else{var o=r[b.getId()],O=o.parentNode;if(b instanceof ht.Group){var _=o.nextSibling;h(Q,o),h(Q,_),delete t[b.getId()]}else h(O,o),0===O.children.length&&(S=q.getDataById(O.$11h),f=S.$12h,f&&!O.contains(f)&&D(O,f));delete r[b.getId()]}}$.$4h={};var F=function(){var O=$._59I,s=0;$.$32h!=R&&(clearInterval($.$32h),s=0,delete $.$32h),$.$32h=setInterval(function(){$.$31h(),O===$._59I?(s++,s>=2&&(clearInterval($.$32h),delete $.$32h)):(s=0,O=$._59I)},30)};for(var V in t)if(E=t[V],b=q.getDataById(t[V].$11h),$.$15h(b),$._drawToolsIcon(b),b.isExpanded()){if(E.style.maxHeight===0+H){var J=E.scrollHeight+$._itemMargin+H;c(E).duration(200).set(v,J).set("padding-bottom",$._itemMargin+H).end(function(){return function(){F()}}(J))}else E.style.maxHeight=E.scrollHeight+H;E.style.paddingBottom=$._itemMargin+H}else E.style.maxHeight!==0+H&&c(E).duration(200).set(v,G).set("padding-bottom",G).end(function(){return function(){F()}}(E));$.$28h(),$.$31h()},$31h:function(){for(var b=this,l=b._view,L=0,Z=l.children,k=0;k<Z.length;k++){var $=Z[k];$.className&&$.className.indexOf("palette-")>=0&&(L+=$.offsetHeight)}b._59I=L,b.$30h=b.$33h(b.ty());var c=b.ty();l.scrollTop=-c,b._29I={x:0,y:-c,width:l.clientWidth,height:l.clientHeight},K(b._79O,Q,-c+H),b._93I()},$33h:function(A){var q=this,i=q._29I.height-q._59I;return i>A&&(A=i),A>0?0:Math.round(A)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(t){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(t.property)<0&&this.redraw(),"translateY"===t.property&&(this.iv(),this._43o())},findDataByName:function(d){for(var L=this.dm().getDatas(),N=0;N<L.size();N++){var V=L.get(N);if(V.getName()===d)return V}},setDataModel:function(g){var L=this,F=L._dataModel,R=L._selectionModel;F!==g&&(F&&(F.umm(L.$6h,L),F.umd(L.$8h,L),F.umh(L.$7h,L),R||F.sm().ums(L.$28h,L)),L._dataModel=g,g.mm(L.$6h,L),g.md(L.$8h,L),g.mh(L.$7h,L),R?R._21I(g):g.sm().ms(L.$28h,L),L.sm().setSelectionMode("single"),L.fp("dataModel",F,g))},$6h:function(t){var d=this,K=d._view,w=t.data,s=d.$4h;"add"===t.kind?s[w.getId()]=w:"remove"===t.kind?s[w.getId()]=w:"clear"===t.kind&&(d.$10h={},d.$9h={},d.$4h={},K[P]=""),d.iv()},$7h:function(o){var e=this,I=o.data;e.$4h[I.getId()]=I,e.iv()},$8h:function(S){var V=this,P=S.data,j=S.property;"expanded"===j?V.iv():(V.$4h[P.getId()]=P,V.iv())},$28h:function(){var S,A=this,_=A.sm(),F="palette-item",O=_.ld();this.dm().each(function(E){S=A.$10h[E.getId()],S&&S[U].indexOf(F)>=0&&(E===O?K(S,f,z.paletteItemSelectBackground):T(S,f))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);